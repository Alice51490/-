<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>Â∑ùÈÅäÈ§®„Éó„É≠„Ç∏„Çß„ÇØ„ÉàÔΩû„Éï„Ç£„ÉÉ„Ç∑„É•„Éï„É≥„Çø„Éº„Å∏„ÅÆÈÅìÔΩû</title>
    <style>
        body {
            font-family: sans-serif;
            text-align: center;
            background: #e0f7fa;
            margin: 0;
            padding: 20px;
        }

        button {
            font-size: 20px;
            padding: 10px 20px;
            margin: 10px;
        }

        #log, #catchLog {
            margin-top: 20px;
            white-space: pre-wrap;
            background: #fff;
            padding: 15px;
            border-radius: 10px;
            border: 1px solid #ccc;
            width: 80%;
            margin-left: auto;
            margin-right: auto;
        }

        .highlight {
            color: green;
            font-weight: bold;
        }

        #fishImage {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0);
            transition: transform 0.5s ease-out;
            z-index: 1000;
        }

        #fishImage.show {
            transform: translate(-50%, -50%) scale(1);
            animation: pop 1s ease-in-out;
        }

        @keyframes pop {
            0% { transform: translate(-50%, -50%) scale(0); }
            60% { transform: translate(-50%, -50%) scale(1.2); }
            100% { transform: translate(-50%, -50%) scale(1); }
        }

        #fishingScene {
            position: relative;
            height: 150px;
            margin-top: 30px;
        }

        .fish-shadow {
            position: absolute;
            width: 60px;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            opacity: 0.5;
            animation: swim 3s infinite ease-in-out;
        }

        @keyframes swim {
            0% { transform: translateX(-50%) translateY(0px); }
            50% { transform: translateX(-50%) translateY(-20px); }
            100% { transform: translateX(-50%) translateY(0px); }
        }
    </style>
</head>
<body>
    <h1>Â∑ùÈÅäÈ§®„Éó„É≠„Ç∏„Çß„ÇØ„ÉàÔΩû„Éï„Ç£„ÉÉ„Ç∑„É•„Éï„É≥„Çø„Éº„Å∏„ÅÆÈÅìÔΩû</h1>
    <p>„Éñ„É™„Çí10ÂåπÈá£„Çä‰∏ä„Åí„Çå„Å∞„ÇØ„É™„Ç¢ÔºÅ</p>
    <button id="fishButton">Èá£„ÇäÈñãÂßãÔºÅ</button>

    <div id="fishingScene" style="display:none;">
	   <img src="-/sakana/hari.png" class="fish-shadow">
    </div>

    <div id="catchLog"></div>
    <div id="log"></div>

    <img id="fishImage" src="" alt="Èá£„Çå„ÅüÈ≠öÔºÅ" width="200">

    <audio id="winSound" src="https://soundeffect-lab.info/sound/voice/mp3/human/human_voice_cheer_boy01.mp3" preload="auto"></audio>

    <script>
        let buriCount = 0;
        let hiramasaCount = 0;
        let kanpachiCount = 0;
        let fishing = false;
        let shaking = false;
        let fishTimeout;
        let loseStreak = 0;

        const log = document.getElementById("log");
        const catchLog = document.getElementById("catchLog");
        const winSound = document.getElementById("winSound");
        const fishImage = document.getElementById("fishImage");
        const fishingScene = document.getElementById("fishingScene");

        const fishImages = {
            "„Éñ„É™": "-/sakana/buri.png",
            "„Éí„É©„Éû„Çµ": "-/sakana/masa.png",
            "„Ç´„É≥„Éë„ÉÅ": "-/sakana/pati.jpg"
        };

        const failMessages = [
            "„Åè„Å£‚Ä¶ÈÄÉ„Åí„Çâ„Çå„Åü‚Ä¶ÔºÅ",
            "„ÅÇ„ÅÇ„Å£ÔºÅÊÉú„Åó„Åã„Å£„ÅüÔºÅ",
            "È≠ö„ÅÆÊñπ„Åå‰∏ÄÊûö‰∏äÊâã„Å†„Å£„Åü„Çà„ÅÜ„Å†‚Ä¶",
            "ÁõÆ„ÅÆÂâç„Åß„Çπ„É´„É™„Å®ÈÄÉ„Åí„Åü‚Ä¶",
            "„Å™„Å´„Å£‚Ä¶ÔºÅÔºüÈÄÉ„Åí„Çâ„Çå„ÅüÔºÅÔºü"
        ];

        document.getElementById("fishButton").onclick = () => {
            if (fishing) {
                if (shaking) {
                    clearTimeout(fishTimeout);
                    shaking = false;
                    fishingScene.style.display = "none";
                    initiateDuel();
                } else {
                    logMessage("‚Ä¶„Åæ„Å†È≠ö„ÅØ„Åã„Åã„Å£„Å¶„ÅÑ„Å™„ÅÑ‚Ä¶");
                }
            } else {
                clearLog();
                startFishing();
            }
        };

        function clearLog() {
            log.textContent = "";
        }

        function updateCatchLog() {
            catchLog.textContent = `üêü „Éñ„É™: ${buriCount}Âåπ\nüê† „Éí„É©„Éû„Çµ: ${hiramasaCount}Âåπ\nüé£ „Ç´„É≥„Éë„ÉÅ: ${kanpachiCount}Âåπ`;
        }

        function resetCatch() {
            buriCount = 0;
            hiramasaCount = 0;
            kanpachiCount = 0;
            updateCatchLog();
        }

        function logMessage(message, highlight = false) {
            const span = document.createElement("span");
            span.textContent = message + "\n";
            if (highlight) span.classList.add("highlight");
            log.prepend(span);
        }

        function startFishing() {
            logMessage("Èá£„ÇäÁ≥∏„ÇíÂûÇ„Çâ„Åó„Åü‚Ä¶");
            fishing = true;
            fishingScene.style.display = "block";
            const waitTime = Math.random() * 10000 + 3000;
            fishTimeout = setTimeout(() => {
                shaking = true;
                logMessage("Èá£„ÇäÁ≥∏„ÅåÈúá„Åà„Å¶„ÅÑ„ÇãÔºÅ„ÇØ„É™„ÉÉ„ÇØ„Åó„Å¶ÂØæÊ±∫„Å†ÔºÅ");
                setTimeout(() => {
                    if (shaking) {
                        logMessage(randomFailMessage());
                        fishing = false;
                        shaking = false;
                        fishingScene.style.display = "none";
                    }
                }, 5000);
            }, waitTime);
        }

        function randomFailMessage() {
            return failMessages[Math.floor(Math.random() * failMessages.length)];
        }

        function rollDice() {
            return [1, 2, 3].map(() => Math.floor(Math.random() * 6) + 1);
        }

        function getPoints(dice) {
            const counts = {};
            for (const d of dice) counts[d] = (counts[d] || 0) + 1;
            const values = Object.values(counts);
            if (values.includes(3)) return dice[0] === 1 ? 25 : 20;
            const sorted = [...dice].sort((a, b) => a - b);
            if (JSON.stringify(sorted) === JSON.stringify([1, 2, 3])) return 0;
            if (JSON.stringify(sorted) === JSON.stringify([4, 5, 6])) return 15;
            return dice.reduce((a, b) => a + b);
        }

        function initiateDuel() {
            logMessage("„ÅÑ„ÅñÂãùË≤†‚Ä¶ÔºÅ");
            setTimeout(() => {
                duel();
            }, 1500);
        }

        function duel() {
            const player = rollDice();
            const fish = rollDice();
            const playerPoints = getPoints(player);
            const fishPoints = getPoints(fish);

            logMessage(`„Éó„É¨„Ç§„É§„Éº„ÅÆÂá∫ÁõÆ: ${player.join(", ")} ‚Üí ${playerPoints}ÁÇπ`);
            logMessage(`È≠ö„ÅÆÂá∫ÁõÆ: ${fish.join(", ")} ‚Üí ${fishPoints}ÁÇπ`);

            if (playerPoints > fishPoints) {
                loseStreak = 0;
                winSound.play();

                const r = Math.random();
                let fishName = "";
                if (r < 0.2) {
                    fishName = "„Éñ„É™";
                    buriCount++;
                } else if (r < 0.7) {
                    fishName = "„Éí„É©„Éû„Çµ";
                    hiramasaCount++;
                } else {
                    fishName = "„Ç´„É≥„Éë„ÉÅ";
                    kanpachiCount++;
                }

                logMessage(`ÂãùÂà©ÔºÅ${fishName}„ÇíÈá£„Çä‰∏ä„Åí„ÅüÔºÅ`, true);
                updateCatchLog();
                showFishImage(fishName);

                if (buriCount >= 10) {
                    logMessage("üéâ „Åä„ÇÅ„Åß„Å®„ÅÜÔºÅÂêõ„ÅØÁúü„ÅÆ„Éï„Ç£„ÉÉ„Ç∑„É•„Éï„É≥„Çø„Éº„Å†ÔºÅÔºÅ", true);
                    document.getElementById("fishButton").disabled = true;
                    return;
                }
            } else {
                loseStreak++;
                logMessage(randomFailMessage());
                if (loseStreak >= 5) {
                    logMessage("Á¶ÅÊñ≠„ÅÆ„ÉÅ„É≥„ÉÅ„É≠„Éá„É•„Ç®„É´„ÅÆ‰ª£ÂÑü„Å´„Çà„Çä‚Ä¶Âêõ„ÅØÊ≠ª„Çì„Å†‚Ä¶„ÄÇÈá£Êûú„ÅØ„Åô„Åπ„Å¶Â§±„Çè„Çå„Åü‚Ä¶‚Ä¶", true);
                    resetCatch();
                    loseStreak = 0;
                }
            }

            fishing = false;
        }

        function showFishImage(fishName) {
            fishImage.src = fishImages[fishName];
            fishImage.classList.add("show");
            setTimeout(() => {
                fishImage.classList.remove("show");
            }, 2000);
        }

        updateCatchLog();
    </script>
</body>
</html>
